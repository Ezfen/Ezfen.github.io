<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Chris Cheungâ€™s blog | iOS | Design | Mood">
    

    <!--Author-->
    
        <meta name="author" content="é˜¿æ¾¤">
    

    <!-- Title -->
    
    <title>ç®€ç®€å•å•è¯´è¯´PKI On iOS | OAOA</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Highlight Code-->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/atom-one-light.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/search.css">

    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <link rel="shortcut icon" href="/favicon.png">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

    <!-- Content -->
    <section class="article-container">
<!-- Back Home -->
<a class="nav-back" href="/">
    <i class="fa fa-home"></i>
</a>

<!-- Page Header -->
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>ç®€ç®€å•å•è¯´è¯´PKI On iOS</h1>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>Hacker,é—®ä½ æƒŠæœªÎ£( Â° â–³ Â°|||)ï¸´</p>
<a id="more"></a>
<p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/Crypto_Sherlock.jpg" alt="ç¥æ¢å¤æ´›å…‹"> </p>
<p>çœ‹äº†å¾ˆå¤šä¾¦æ¢ç‰‡ä¹‹åï¼Œé€æ¸å‘ç°åŠ è§£å¯†çš„ç¥å¥‡æ‰€åœ¨ã€‚èƒ½å¤Ÿåœ¨åˆ«äººæ— æ³•å¯Ÿè§‰çš„æƒ…å†µä¸‹ä¼ é€’ä¿¡æ¯ï¼ˆæˆ‘å¾ˆå–œæ¬¢çœ‹è¿™äº›ç‰‡å­ï¼Œå“ˆå“ˆå“ˆï¼‰ã€‚æ— è®ºæ˜¯Morse Codeè¿˜æ˜¯å¯¹ç€æŸæœ¬ä¹¦æ ¹æ®é¡µç è¡Œæ•°å­—æ•°æ¥ç¡®å®šè¡¨è¾¾ä¿¡æ¯ï¼Œéƒ½èƒ½è®©æˆ‘çœ‹åˆ°å‰äººçš„æ™ºæ…§ã€‚è¯´çœŸçš„ï¼Œæˆ‘ç‰¹åˆ«é’Ÿæ„ç¥æ¢å¤æ´›å…‹ï¼Œå°±ç®—è‹±æ–‡æ¸£æ¸£ä¹Ÿä¼šåœ¨æ›´æ–°çš„æ—¶å€™åˆ°Youtubeä¸Šçœ‹çœ‹ï¼Œç­‰ç¿»è¯‘å®Œå†ç¿»çœ‹ä¸€æ¬¡ã€‚è®°å¾—ä¸­å›½å‰§åœºé‚£ä¸€é›†æœ€åæ ¹æ®ä¼¦æ•¦åœ°å›¾ç ´è§£äº†è—åœ¨è‹å·ç å­é‡Œçš„æš—å·ï¼ŒSo Sexy~Â·Â·<br>â€‹<br>ä»Šå¤©æ¥èŠèŠé˜¿æ¾¤å›çš„æ•…äº‹ï¼Œé¡ºä¾¿è°ˆè°ˆ</p>
<ol>
<li>CommonCrytoä¸­å…³äºDESã€AESçš„éƒ¨åˆ†å†…å®¹</li>
<li>iOSçš„Securityæ¡†æ¶é‡Œå…³äºRSAåŠ å¯†çš„éƒ¨åˆ†å†…å®¹â€¦.</li>
</ol>
<p>é˜¿æ¾¤å›æ˜¯ä¸ªå¤§å››ğŸ¶ï¼Œæœ€è¿‘åœ¨çƒ¦æ¯•ä¸šè®ºæ–‡çš„äº‹æƒ…ã€‚è¾›è¾›è‹¦è‹¦æ’¸äº†äºŒåä¸ªå¹´(xiao)å¤´(shi)çš„è®ºæ–‡ï¼Œè‚¯å®šè¦ç¬¬ä¸€æ—¶é—´äº¤åˆ°è€å¸ˆæ‰‹é‡Œï¼Œè®©ä»–çœ‹çœ‹ï¼Œå¥½èˆ’ç¼“é˜¿æ¾¤å›éš¾äº§çš„å¿ƒæƒ…ã€‚é˜¿æ¾¤å›çŸ¥é“æœ‰ä¸ªHackerå›ä¸€ç›´åœ¨è§Šè§é˜¿æ¾¤å›çš„è®ºæ–‡ï¼Œæƒ³æ‹¿è¿‡æ¥ä¸€æŠ„äº†ä¹‹ã€‚è€Œä¸”Hackerå›æ˜¯ä¸€æµçš„ç½‘ç»œé»‘å®¢ï¼Œç›—çº¿å·å–åˆ«äººçš„ä¿¡æ¯æ˜¯æœ€åœ¨è¡Œçš„äº†ã€‚å› æ­¤æ€ä¹ˆå‘ç»™åƒé‡Œä¹‹å¤–çš„è€å¸ˆå¯éš¾ä¸ºé˜¿æ¾¤å›äº†ã€‚ã€‚ã€‚    </p>
<p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/common/focusOnCom.jpg" alt="æ²‰æ€...">    </p>
<p>å¾ˆå¿«ï¼Œé˜¿æ¾¤å›æƒ³åˆ°ç”¨åŠ å¯†çš„æ–¹æ³•ï¼Œåˆ©ç”¨å¯¹ç§°åŠ å¯†çš„æ–¹æ³•ç»™è®ºæ–‡åŠ å¯†åå‘é€ç»™è€å¸ˆã€‚</p>
<p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/common/bucuowo.jpg" alt="å¼€å¿ƒ"></p>
<h1 id="å¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†</h1><p>é‡‡ç”¨å•é’¥å¯†ç ç³»ç»Ÿçš„åŠ å¯†æ–¹æ³•ï¼ŒåŒä¸€ä¸ªå¯†é’¥å¯ä»¥åŒæ—¶ç”¨ä½œä¿¡æ¯çš„åŠ å¯†å’Œè§£å¯†ã€‚åŠ å¯†ç®—æ³•ä¸­æ•°DESã€3DESã€AES(å—ç®—æ³•)å’ŒRC4(æµç®—æ³•)æœ€ä¸ºå¸¸ç”¨äº†ã€‚</p>
<h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><p>DES ä½¿ç”¨ä¸€ä¸ª 56 ä½çš„å¯†é’¥ä»¥åŠé™„åŠ çš„ 8 ä½å¥‡å¶æ ¡éªŒä½ï¼Œäº§ç”Ÿæœ€å¤§ 64 ä½çš„åˆ†ç»„å¤§å°ã€‚è¿™æ˜¯ä¸€ä¸ªè¿­ä»£çš„åˆ†ç»„å¯†ç ï¼Œä½¿ç”¨ç§°ä¸º Feistel çš„æŠ€æœ¯ï¼Œå…¶ä¸­å°†åŠ å¯†çš„æ–‡æœ¬å—åˆ†æˆä¸¤åŠã€‚ä½¿ç”¨å­å¯†é’¥å¯¹å…¶ä¸­ä¸€åŠåº”ç”¨å¾ªç¯åŠŸèƒ½ï¼Œç„¶åå°†è¾“å‡ºä¸å¦ä¸€åŠè¿›è¡Œâ€œå¼‚æˆ–â€è¿ç®—ï¼›æ¥ç€äº¤æ¢è¿™ä¸¤åŠï¼Œè¿™ä¸€è¿‡ç¨‹ä¼šç»§ç»­ä¸‹å»ï¼Œä½†æœ€åä¸€ä¸ªå¾ªç¯ä¸äº¤æ¢ã€‚DES ä½¿ç”¨ 16 ä¸ªå¾ªç¯ï¼Œä½¿ç”¨å¼‚æˆ–ï¼Œç½®æ¢ï¼Œä»£æ¢ï¼Œç§»ä½æ“ä½œå››ç§åŸºæœ¬è¿ç®—ã€‚    </p>
<p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/Crypto_DES.jpg" alt="DES">    </p>
<p>å›¾ç‰‡æ˜¯åº¦å¨˜æ‰¾çš„ï¼Œå°†å°±çœ‹çœ‹å“ˆ~</p>
<h3 id="3DES"><a href="#3DES" class="headerlink" title="3DES"></a>3DES</h3><p>3DESæ˜¯åœ¨DESçš„åŸºç¡€ä¸Šåšäº†ä¸¤æ¬¡åŠ å¯†å’Œä¸€æ¬¡è§£å¯†ã€‚å…·ä½“å®ç°å¦‚ä¸‹ï¼šè®¾Ek()å’ŒDk()ä»£è¡¨DESç®—æ³•çš„åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ï¼ŒKä»£è¡¨DESç®—æ³•ä½¿ç”¨çš„å¯†é’¥ï¼ŒPä»£è¡¨æ˜æ–‡ï¼ŒCä»£è¡¨å¯†æ–‡ï¼Œè¿™æ ·ï¼š<br>3DESåŠ å¯†è¿‡ç¨‹ä¸ºï¼šC=Ek3(Dk2(Ek1(P)))<br>3DESè§£å¯†è¿‡ç¨‹ä¸ºï¼šP=Dk1(EK2(Dk3(C)))<br>è‹¥<strong>Ek1 == Ek2 == Ek3</strong>ï¼Œå°±æ˜¯ç®€å•çš„DESäº†ã€‚</p>
<h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/Crypto_AES.png" alt="AES"><br>å›¾ç‰‡æ¥è‡ªç½‘ç»œï¼Œè‹¥æœ‰ä¾µçŠ¯åˆ°æƒåˆ©ä¹‹å¤„ï¼Œè¯·å‘ŠçŸ¥ï¼Œè°¢è°¢~    </p>
<p>AESåŠ å¯†è¿‡ç¨‹æ¶‰åŠåˆ°4ç§æ“ä½œï¼šå­—èŠ‚æ›¿ä»£ï¼ˆSubBytesï¼‰ã€è¡Œç§»ä½ï¼ˆShiftRowsï¼‰ã€åˆ—æ··æ·†ï¼ˆMixColumnsï¼‰å’Œè½®å¯†é’¥åŠ ï¼ˆAddRoundKeyï¼‰ã€‚è§£å¯†è¿‡ç¨‹åˆ†åˆ«ä¸ºå¯¹åº”çš„é€†æ“ä½œã€‚ç”±äºæ¯ä¸€æ­¥æ“ä½œéƒ½æ˜¯å¯é€†çš„ï¼ŒæŒ‰ç…§ç›¸åçš„é¡ºåºè¿›è¡Œè§£å¯†å³å¯æ¢å¤æ˜æ–‡ã€‚åŠ è§£å¯†ä¸­æ¯è½®çš„å¯†é’¥åˆ†åˆ«ç”±åˆå§‹å¯†é’¥æ‰©å±•å¾—åˆ°ã€‚ç®—æ³•ä¸­16å­—èŠ‚çš„æ˜æ–‡ã€å¯†æ–‡å’Œè½®å¯†é’¥éƒ½ä»¥ä¸€ä¸ª4x4çš„çŸ©é˜µè¡¨ç¤ºã€‚<br>ç®—æ³•è¯¦ç»†å·²ç»æœ‰å…¶ä»–äººå†™äº†ï¼Œæˆ‘å°±ä¸å†é€ è½®å­äº†ã€‚<a href="http://www.blogfshare.com/aes-rijndael.html" target="_blank" rel="external">å¯†ç ç®—æ³•è¯¦è§£â€”â€”AES</a><br>è¿˜æœ‰ç®—æ³•åŠè§£å¯†ç®—æ³•çš„<a href="http://blog.csdn.net/searchsun/article/details/2516191" target="_blank" rel="external">æ¨¡å¼ä»‹ç»</a>ï¼Œå¯ä»¥äº†è§£äº†è§£~    </p>
<h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><p>ä¸åŒäºå—ç®—æ³•çš„æ˜¯ï¼ŒRC4ç­‰æµç®—æ³•ä¸æ˜¯å¯¹æ˜æ–‡è¿›è¡Œåˆ†ç»„å¤„ç†ï¼Œè€Œæ˜¯å­—èŠ‚æµçš„æ–¹å¼ä¾æ¬¡åŠ å¯†æ˜æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚ï¼Œè§£å¯†çš„æ—¶å€™ä¹Ÿæ˜¯ä¾æ¬¡å¯¹å¯†æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚è¿›è¡Œè§£å¯†ã€‚</p>
<h2 id="CommonCrypto"><a href="#CommonCrypto" class="headerlink" title="CommonCrypto"></a>CommonCrypto</h2><p>å¯¹äºèº«ä¸ºiOSæ”»åŸç‹®çš„é˜¿æ¾¤å›æ¥è¯´ï¼Œæ„Ÿè§‰è¿˜æ˜¯è¿™ä¸€éƒ¨åˆ†æ¯”è¾ƒé‡è¦ã€‚    </p>
<h3 id="CommonCryptoçš„ä¸€äº›ä¸»è¦çš„ç»“æ„ä½“"><a href="#CommonCryptoçš„ä¸€äº›ä¸»è¦çš„ç»“æ„ä½“" class="headerlink" title="CommonCryptoçš„ä¸€äº›ä¸»è¦çš„ç»“æ„ä½“"></a>CommonCryptoçš„ä¸€äº›ä¸»è¦çš„ç»“æ„ä½“</h3><ol>
<li>CCOperationï¼šå®šä¹‰æ“ä½œï¼šåŠ å¯†æˆ–è§£å¯†</li>
</ol>
<pre><code>enum {
    kCCEncrypt = 0, 
    kCCDecrypt,     
};
typedef uint32_t CCOperation;
</code></pre><ol>
<li>CCAlgorithmï¼šåŠ è§£å¯†ç®—æ³•ï¼Œå¾ˆæ˜æ˜¾å°±ä¸è¯¦ç»†è¯´æ˜äº†ã€‚</li>
</ol>
<pre><code class="objc">enum {
    kCCAlgorithmAES128 = 0,
    kCCAlgorithmAES = 0,
    kCCAlgorithmDES,
    kCCAlgorithm3DES,       
    kCCAlgorithmCAST,       
    kCCAlgorithmRC4,
    kCCAlgorithmRC2,   
    kCCAlgorithmBlowfish    
};
typedef uint32_t CCAlgorithm;
</code></pre>
<ol>
<li>CCOptionsï¼šé€‰é¡¹ï¼šæŒ‰ç…§P7è¡¥è¶³å—ç®—æ³•çš„å—é•¿åº¦æˆ–è€…é€‰æ‹©ECBæ¨¡å¼ï¼Œå…³äºæ¨¡å¼è¯·çœ‹ä¸Šé¢AESä¸­ä»‹ç»çš„æ–‡ç« ã€‚å¯¹äºRC4ç­‰æµç®—æ³•ä¸é€‚ç”¨ã€‚æˆ–è€…è¯´ä¸éœ€è¦ä½¿ç”¨åˆ°</li>
</ol>
<pre><code class="objc">enum {
    kCCOptionPKCS7Padding   = 0x0001,
    kCCOptionECBMode        = 0x0002
};
</code></pre>
<ol>
<li>KeySizeå’ŒBlockSizeï¼šè§„å®šåŠ è§£å¯†å¯†é’¥çš„é•¿åº¦å’Œæ˜æ–‡å¯†æ–‡å—çš„é•¿åº¦</li>
</ol>
<pre><code class="objc">enum {
    kCCKeySizeAES128          = 16,
    kCCKeySizeAES192          = 24,
    kCCKeySizeAES256          = 32,
    kCCKeySizeDES             = 8,
    kCCKeySize3DES            = 24,
    kCCKeySizeMinCAST         = 5,
    kCCKeySizeMaxCAST         = 16,
    kCCKeySizeMinRC4          = 1,
    kCCKeySizeMaxRC4          = 512,
    kCCKeySizeMinRC2          = 1,
    kCCKeySizeMaxRC2          = 128,
    kCCKeySizeMinBlowfish     = 8,
    kCCKeySizeMaxBlowfish     = 56,
};
enum {
    /* AES */
    kCCBlockSizeAES128        = 16,
    /* DES */
    kCCBlockSizeDES           = 8,
    /* 3DES */
    kCCBlockSize3DES          = 8,
    /* CAST */
    kCCBlockSizeCAST          = 8,
    kCCBlockSizeRC2           = 8,
    kCCBlockSizeBlowfish      = 8,
};
</code></pre>
<h3 id="é€šè¿‡ä»£ç å®ç°"><a href="#é€šè¿‡ä»£ç å®ç°" class="headerlink" title="é€šè¿‡ä»£ç å®ç°"></a>é€šè¿‡ä»£ç å®ç°</h3><h4 id="å¯¼å…¥CommonCryptoçš„å¤´æ–‡ä»¶ã€‚"><a href="#å¯¼å…¥CommonCryptoçš„å¤´æ–‡ä»¶ã€‚" class="headerlink" title="å¯¼å…¥CommonCryptoçš„å¤´æ–‡ä»¶ã€‚"></a>å¯¼å…¥CommonCryptoçš„å¤´æ–‡ä»¶ã€‚</h4><pre><code class="objc">#import &lt;CommonCrypto/CommonCrypto.h&gt;
</code></pre>
<h4 id="symCrypt"><a href="#symCrypt" class="headerlink" title="symCrypt"></a>symCrypt</h4><pre><code class="objc">/*!
    @function   symCrypt
    @abstract   å¯¹ç§°è§£å¯†
    @param      operation       åŠ å¯†æˆ–è§£å¯†
    @param      data            éœ€è¦åŠ è§£å¯†çš„æ•°æ®
    @param      algorithm       åŠ è§£å¯†æ‰€é‡‡ç”¨çš„ç®—æ³•
    @param      key             åŠ è§£å¯†æ—¶æä¾›çš„å¯†é’¥
    @param      iv              Initialization Vector(CBCæ¨¡å¼ä¸‹éœ€è¦)
    @param      options         åŠ å¯†æ•°æ®å­—èŠ‚æ•°ä¸æ˜¯blockçš„æ•´æ•°å€æ—¶éœ€è¦åˆ¶å®špadding
                                è¯¦æƒ…å‚è§CommonCryptorå¤´æ–‡ä»¶
    @param      status          åŠ è§£å¯†æˆåŠŸä¸å¦æ‰€è¿”å›çš„çŠ¶æ€
    @result     è§£å¯†åå¾—åˆ°çš„ç»“æœ
 */
- (NSData *)symCrypt:(CCOperation)operation
         processData:(NSData *)data
      UsingAlgorithm:(CCAlgorithm)algorithm
                 key:(NSData *)key
 initalizationVector:(NSData *)iv
             options:(CCOptions)options
              status:(CCCryptorStatus *)status
{
    NSData *result = nil;
    NSMutableData *cKey = [key mutableCopy], *cIV = [iv mutableCopy];
    [self fixKeyLengthsByAlgorithm:algorithm keyData:cKey ivData:cIV];//1
    size_t bufferSize = [data length] + [self blockSizeByAlgorithm:algorithm]; // 2
    void *buffer = malloc(bufferSize); //3
    size_t encryptedSize = 0;
    *status = CCCrypt(operation, algorithm, options, [cKey bytes], [cKey length], [cIV bytes], [data bytes], [data length], buffer, bufferSize, &amp;encryptedSize); //4
    if (*status == kCCSuccess) {
        result = [NSData dataWithBytes:buffer length:encryptedSize];  //5
    } else {
        NSLog(@&quot;[ERROR] failed to encrypt|CCCryptoStatus: %d&quot;, *status);
    }
    free(buffer);  //6
    return result;  //7
}
</code></pre>
<ol>
<li>æ ¹æ®åŠ è§£å¯†ç®—æ³•æ£€æŸ¥Keyå’Œivçš„é•¿åº¦æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œè¯¦ç»†è¯·çœ‹ä¸‹é¢åˆ—å‡ºçš„å‡½æ•°fixKeyLength</li>
<li>åŠ å¯†åçš„æ•°æ®æ€»å°äºç­‰äºæ•°æ®é•¿åº¦åŠ ä¸Šblockçš„å¤§å°</li>
<li>ç”³è¯·bufferSizeçš„ç©ºé—´ä»¥ä¿å­˜åŠ å¯†æˆ–è§£å¯†åçš„æ•°æ®</li>
<li>è°ƒç”¨CCCryptå‡½æ•°å®ç°åŠ è§£å¯†ã€‚<pre><code class="objc">CCCryptorStatus CCCrypt(
 CCOperation op,         /* åŠ å¯†æˆ–è§£å¯†ï¼škCCEncrypt, etc. */
 CCAlgorithm alg,        /* åŠ è§£å¯†é‡‡ç”¨çš„ç®—æ³•ï¼škCCAlgorithmAES128, etc. */
 CCOptions options,      /* kCCOptionPKCS7Padding, etc. */
 const void *key,        /* å¯†é’¥ */
 size_t keyLength,       /* å¯†é’¥é•¿åº¦ */
 const void *iv,         /* ivï¼Œä½¿ç”¨ä¸CBCæ¨¡å¼ä¸‹ï¼Œæ˜æ–‡å32ä½å’Œivå¼‚æˆ–ååšä¸ºä¸‹ä¸€é˜¶æ®µçš„å‰32ä½ */
 const void *dataIn,     /* è¦åŠ å¯†æˆ–è§£å¯†çš„æ•°æ® */
 size_t dataInLength,    /* æ•°æ®é•¿åº¦ */
 void *dataOut,          /* æ³¨æ„ä¼ å…¥çš„æ˜¯æŒ‡é’ˆï¼ŒåŠ è§£å¯†åçš„æ•°æ®å°†ä»æ­¤å¤„è¿”å› */
 size_t dataOutAvailable,/* ä¸ºdataOutç”³è¯·çš„å¯å†™é•¿åº¦ */
 size_t *dataOutMoved    /* ç»“æœæ‰€å çš„é•¿åº¦ */
 )    
 __OSX_AVAILABLE_STARTING(__MAC_10_4, __IPHONE_2_0);
</code></pre>
</li>
<li>è‹¥æˆåŠŸï¼Œåˆ™å°†(void *)ç±»å‹çš„æ•°æ®å°è£…åˆ°NSDataä¸­ã€‚</li>
<li>é‡Šæ”¾ç”³è¯·çš„bufferå†…å­˜</li>
<li>è¿”å›ã€‚</li>
</ol>
<h4 id="fixKeyLength"><a href="#fixKeyLength" class="headerlink" title="fixKeyLength"></a>fixKeyLength</h4><pre><code class="objc">/*!
    @function   fixKeyLength
    @abstract   ä¿®æ”¹å¯†é’¥é•¿åº¦è‡³ä¸ç®—æ³•åŒ¹é…
    @param      algorithm       åŠ è§£å¯†æ‰€é‡‡ç”¨çš„ç®—æ³•
    @param      keyData         å¯†é’¥
    @param      ivData          Initialization Vector
    @result     å°†å¯†é’¥é•¿åº¦å’Œivä¿®æ”¹è‡³ä¸ç®—æ³•åŒ¹é…çš„é•¿åº¦
 */
- (void)fixKeyLengthsByAlgorithm:(CCAlgorithm)algorithm
                         keyData:(NSMutableData *)keyData
                          ivData:(NSMutableData *)ivData
{
    NSUInteger keyLength = [keyData length];
    switch (algorithm) {
        case kCCAlgorithmAES:
        {
            if (keyLength &lt; kCCKeySizeAES128) {
                keyData.length = kCCKeySizeAES128;
            } else if (keyLength &lt; kCCKeySizeAES192) {
                keyData.length = kCCKeySizeAES192;
            } else {
                keyData.length = kCCKeySizeAES256;
            }
            break;
        }
        case kCCAlgorithmDES:
        {
            keyData.length = kCCKeySizeDES;
            break;
        }
        case kCCAlgorithm3DES:
        {
            keyData.length = kCCKeySize3DES;
            break;
        }
        case kCCAlgorithmRC4:
        {
            keyData.length = kCCKeySizeMaxRC4;
            break;
        }
        default:
            break;
    }
    ivData.length = keyData.length;
}
</code></pre>
<h4 id="blockSizeByAlgorithm"><a href="#blockSizeByAlgorithm" class="headerlink" title="blockSizeByAlgorithm"></a>blockSizeByAlgorithm</h4><pre><code class="objc">/*!
    @function   blockSizeByAlgorithm
    @abstract   æ ¹æ®ç®—æ³•è·å–æ¯ä¸ªblockçš„å¤§å°
    @param      algorithm       åŠ å¯†æ‰€é‡‡ç”¨çš„ç®—æ³•
    @result     è¯¥ç®—æ³•å¯¹åº”çš„blockå¤§å°
 */
- (size_t)blockSizeByAlgorithm:(CCAlgorithm)algorithm {
    switch (algorithm) {
        case kCCAlgorithmAES:
            return kCCBlockSizeAES128;
        case kCCAlgorithmDES:
        case kCCAlgorithm3DES:
        case kCCAlgorithmRC4:
            return kCCBlockSizeDES;
        default:
            return 0;
    }
}
</code></pre>
<p>ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°ä¸»è¦æ˜¯ä¸ºäº†è§„èŒƒå¯†é’¥çš„é•¿åº¦å’Œè·å–æ˜æ–‡å¯†æ–‡å—çš„é•¿åº¦ï¼Œå¾ˆå¥½ç†è§£å°±ä¸è¯¦ç»†ä»‹ç»äº†ã€‚è¿™æ ·è¿˜æ˜¯ä¸èƒ½å‚»ç“œå¼åœ°è°ƒç”¨ï¼Œå› æ­¤é˜¿æ¾¤å›åˆ›å»ºäº†DESCipherActorç»§æ‰¿äºSymCipherActorï¼Œè¿›ä¸€æ­¥è¿›è¡Œå°è£…ï¼š<br>ã€€ã€€DESCipherActor.h<br>ã€€ã€€``` objc</p>
<pre><code>- (NSString *)encryptInCBC:(NSString *)plainText key:(NSString *)key iv:(NSData *)iv;
- (NSString *)decryptInCBC:(NSString *)cipherText key:(NSString *)key iv:(NSData *)iv;
- (NSString *)encryptInEBC:(NSString *)plainText key:(NSString *)key;
- (NSString *)decryptInEBC:(NSString *)cipherText key:(NSString *)key;
</code></pre><p>ã€€ã€€```<br>ã€€ã€€è¿˜æœ‰AESã€RC4çš„å®ç°å¤§è‡´ç›¸åŒï¼Œå…·ä½“å¯å‚è€ƒDemoï¼Œå·²ç»ä¸Šä¼ <a href="https://github.com/objchris/PKIDemo" target="_blank" rel="external">Github</a></p>
<p>ã€€ã€€æœç„¶ï¼Œé‡‡ç”¨åŠ å¯†ç®—æ³•åŠ å¯†åçš„è®ºæ–‡é¡ºåˆ©å‘åˆ°è€å¸ˆé‚£é‡Œï¼Œé—®é¢˜æ˜¯è§£å¯†ç”¨å¯†é’¥è¿˜åœ¨é˜¿æ¾¤å›æ‰‹ä¸Šï¼Œè€å¸ˆè¿˜æ˜¯æ— æ³•çœ‹åˆ°è®ºæ–‡å†…å®¹ï¼Œå¯†é’¥ä¸èƒ½é€šè¿‡ç½‘ç»œä¼ è¾“ç»™è€å¸ˆï¼Œå› ä¸ºHackerå›è¿˜åœ¨ç›‘å¬ç€é˜¿æ¾¤å›å’Œè€å¸ˆçš„é€šè®¯ã€‚éš¾é“è¦é˜¿æ¾¤å›ä¸æƒ§åƒé‡Œï¼ˆå…¶å®ä¸æ˜¯å¾ˆè¿œï¼Œå“ˆå“ˆå“ˆã€‚æˆ‘å°±å¤¸å¼ é‚£ä¹ˆä¸€ç‚¹ç‚¹~ï¼‰å»åˆ°è€å¸ˆé‚£è¾¹ï¼Œé‚£ä¸ºä½•ä¸ç›´æ¥å°†è®ºæ–‡äº¤ç»™è€å¸ˆå‘¢ï¼Ÿï¼ï¼ï¼<br>ã€€ã€€What the <em>**</em>ï¼ï¼ï¼ğŸ’”ğŸ’”é˜¿æ¾¤å›æ­¤æ—¶å¿ƒé‡Œåƒä¸‡åªè‰æ³¥é©¬åœ¨å¥”è…¾ã€‚        </p>
<p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/common/desk.jpg" alt="æ€æ¡Œå­">    </p>
<p>ã€€ã€€ä½†æ˜¯é˜¿æ¾¤å›ä¸ä¼šè¿™æ ·è½»æ˜“åœ°ç‹—å¸¦ï¼Œå› ä¸ºè¿˜å¯ä»¥é€šè¿‡éå¯¹ç§°åŠ å¯†æ¥è§£å†³â€¦</p>
<h1 id="éå¯¹ç§°åŠ å¯†"><a href="#éå¯¹ç§°åŠ å¯†" class="headerlink" title="éå¯¹ç§°åŠ å¯†"></a>éå¯¹ç§°åŠ å¯†</h1><p>å¯¹ç§°åŠ å¯†ç®—æ³•åœ¨åŠ å¯†å’Œè§£å¯†æ—¶ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªç§˜é’¥ï¼›è€Œéå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥æ¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œè¿™ä¸¤ä¸ªç§˜é’¥æ˜¯å…¬å¼€å¯†é’¥ï¼ˆpublic keyï¼Œç®€ç§°å…¬é’¥ï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivate keyï¼Œç®€ç§°ç§é’¥ï¼‰ã€‚<br>å¦‚ç”²ä¹™åŒæ–¹éœ€è¦åŠ å¯†é€šä¿¡ï¼š</p>
<ol>
<li>ä¹™æ–¹ç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰å¹¶å°†å…¬é’¥å‘å…¶å®ƒæ–¹å…¬å¼€ã€‚</li>
<li>å¾—åˆ°è¯¥å…¬é’¥çš„ç”²æ–¹ä½¿ç”¨è¯¥å¯†é’¥å¯¹æœºå¯†ä¿¡æ¯è¿›è¡ŒåŠ å¯†åå†å‘é€ç»™ä¹™æ–¹ã€‚</li>
<li>ä¹™æ–¹å†ç”¨è‡ªå·±ä¿å­˜çš„å¦ä¸€æŠŠä¸“ç”¨å¯†é’¥ï¼ˆç§é’¥ï¼‰å¯¹åŠ å¯†åçš„ä¿¡æ¯è¿›è¡Œè§£å¯†ã€‚ä¹™æ–¹åªèƒ½ç”¨å…¶ä¸“ç”¨å¯†é’¥ï¼ˆç§é’¥ï¼‰è§£å¯†ç”±å¯¹åº”çš„å…¬é’¥åŠ å¯†åçš„ä¿¡æ¯ã€‚</li>
</ol>
<p>ã€€ã€€åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œå³ä½¿æ”»å‡»è€…æˆªè·äº†ä¼ è¾“çš„å¯†æ–‡ï¼Œå¹¶å¾—åˆ°äº†ä¹™çš„å…¬é’¥ï¼Œä¹Ÿæ— æ³•ç ´è§£å¯†æ–‡ï¼Œå› ä¸ºåªæœ‰ä¹™çš„ç§é’¥æ‰èƒ½è§£å¯†å¯†æ–‡ã€‚<br>ã€€ã€€åŒæ ·ï¼Œå¦‚æœä¹™è¦å›å¤åŠ å¯†ä¿¡æ¯ç»™ç”²ï¼Œé‚£ä¹ˆéœ€è¦ç”²å…ˆå…¬å¸ƒç”²çš„å…¬é’¥ç»™ä¹™ç”¨äºåŠ å¯†ï¼Œç”²è‡ªå·±ä¿å­˜ç”²çš„ç§é’¥ç”¨äºè§£å¯†ã€‚<br>ã€€ã€€è¯´åˆ°éå¯¹ç§°åŠ å¯†ï¼Œä¸å¾—ä¸è¯´RSAï¼ˆå…¶å®æ˜¯é˜¿æ¾¤å›åªæ¥è§¦è¿‡è¿™ä¸ªã€‚ã€‚ã€‚ï¼‰</p>
<p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/common/yaoMing.png" alt=""></p>
<h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><h3 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h3><ol>
<li>é€‰å–ä¸¤ä¸ªè´¨æ•°på’Œq, è®¡ç®—<code>n = p * q</code> ã€‚på’Œqè¦å°½é‡å¤§</li>
<li>æ ¹æ®è´¨æ•°<code>Ï†(p)=p-1</code>å’Œæ¬§æ‹‰æ–¹ç¨‹æ»¡è¶³ä¹˜æ³•ç»“åˆç‡çš„è§„å¾‹æ±‚å‡ºÏ†(n),å³<code>Ï†(n)=(p-1)(q-1)</code></li>
<li>é€‰å–è´¨æ•°eä½œä¸ºå…¬é’¥æŒ‡æ•°, eçš„èŒƒå›´<code>1&lt;e&lt;Ï†(n)</code>,ä¸” e ä¸ Ï†(n) äº’è´¨</li>
<li>å‡ºeå¯¹Ï†(n)çš„æ¨¡åå…ƒç´ dï¼Œæ±‚è§£å…¬å¼ï¼š<code>ed â‰¡ 1 (mod Ï†(n))</code>å³å¯å¾—å‡º<br>è¿™æ ·è®¡ç®—å(n,e)æ˜¯å…¬é’¥ï¼Œ(n,d)æ˜¯ç§é’¥ã€‚<blockquote>
<p>å…¬é’¥åŠ å¯†å…¬å¼<br>m^e â‰¡ c (mod n) å³ c = m^e mod n<br>ç§é’¥è§£å¯†å…¬å¼<br>c^d â‰¡ m (mod n) å³ m = c^d mod n    </p>
</blockquote>
</li>
</ol>
<p>RSAåŠ å¯†å¸¸ç”¨çš„å¡«å……æ–¹å¼æœ‰ä¸‹é¢3ç§ï¼š    </p>
<ol>
<li>RSA_PKCS1_PADDING å¡«å……æ¨¡å¼ï¼Œæœ€å¸¸ç”¨çš„æ¨¡å¼<br>è¾“å…¥ï¼šå¿…é¡» æ¯”RSAé’¥æ¨¡é•¿(modulus)çŸ­è‡³å°‘11ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯RSA_size(rsa) â€“ 11ã€‚å¦‚æœè¾“å…¥çš„æ˜æ–‡è¿‡é•¿ï¼Œå¿…é¡»åˆ‡å‰²ï¼Œç„¶åå¡«å……<br>è¾“å‡ºï¼šå’Œmodulusä¸€æ ·é•¿<br>æ ¹æ®è¿™ä¸ªè¦æ±‚ï¼Œå¯¹äº1024bitçš„å¯†é’¥ï¼Œblock length = 1024/8 â€“ 11 = 117 å­—èŠ‚     </li>
<li>RSA_PKCS1_OAEP_PADDING<br>è¾“å…¥ï¼šRSA_size(rsa) â€“ 41<br>è¾“å‡ºï¼šå’Œmodulusä¸€æ ·é•¿    </li>
<li>for RSA_NO_PADDING ä¸å¡«å……<br>è¾“å…¥ï¼šå¯ä»¥å’ŒRSAé’¥æ¨¡é•¿ä¸€æ ·é•¿ï¼Œå¦‚æœè¾“å…¥çš„æ˜æ–‡è¿‡é•¿ï¼Œå¿…é¡»åˆ‡å‰²ï¼Œç„¶åå¡«å……<br>è¾“å‡ºï¼šå’Œmodulusä¸€æ ·é•¿    </li>
</ol>
<p>ç‰¹åˆ«æ¨èçš„æ˜¯é˜®ä¸€å³°çš„æ—¥å¿—ä¸¤ç¯‡æ—¥å¿—ï¼Œå†™å¾—éå¸¸å¥½ï¼Œæˆ‘ä¹Ÿæ˜¯å‚è€ƒè¿™ä¸ªå†™çš„ï¼š<br><a href="http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html" target="_blank" rel="external">RSAç®—æ³•åŸç†ï¼ˆä¸€ï¼‰</a><br><a href="http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html" target="_blank" rel="external">RSAç®—æ³•åŸç†ï¼ˆäºŒï¼‰</a></p>
<h3 id="iOS-Security-framework"><a href="#iOS-Security-framework" class="headerlink" title="iOS Security.framework"></a>iOS Security.framework</h3><h4 id="encryptWithPublicKey"><a href="#encryptWithPublicKey" class="headerlink" title="encryptWithPublicKey"></a>encryptWithPublicKey</h4><pre><code class="objc">- (NSString *)encrypt:(NSString *)stringToEncrypt withPublicKey:(SecKeyRef)publicKey{
    OSStatus status = noErr;
    size_t cipherBufferSize;
    uint8_t *cipherBuffer;
    uint8_t *dataToEncrypt = (uint8_t *)[stringToEncrypt cStringUsingEncoding:NSUTF8StringEncoding];
    size_t dataLength = stringToEncrypt.length;
    NSLog(@&quot;dataLength: %zu&quot;, dataLength);
    cipherBufferSize = SecKeyGetBlockSize(publicKey);       // 1
    cipherBuffer = malloc(cipherBufferSize);
    size_t totalBufferSize = 0;
    NSMutableData *data = [[NSMutableData alloc] init];    // 2
    //ä½¿ç”¨kSecPaddingPKCS1ä½œä¸ºåŠ å¯†çš„padding
    if ((cipherBufferSize - 11) &lt; dataLength) {            // 3
        //è‹¥éœ€è¦åŠ å¯†çš„æ•°æ®é•¿åº¦è¿‡é•¿ï¼Œéœ€è¦åˆ†å—åŠ å¯†
        size_t toEncryptDataLength = dataLength;
        while ((cipherBufferSize - 11) &lt; toEncryptDataLength) { // 4
            status = SecKeyEncrypt(publicKey,
                                   kSecPaddingPKCS1,
                                   dataToEncrypt + (dataLength - toEncryptDataLength),
                                   cipherBufferSize - 11,
                                   cipherBuffer,
                                   &amp;cipherBufferSize);          // 5
            toEncryptDataLength = toEncryptDataLength - (cipherBufferSize - 11);        //6
            //CipherBufferæ˜¯é€šè¿‡mallocåˆ›å»ºï¼Œæ²¡æœ‰å¯¹å†…å­˜ç©ºé—´è¿›è¡Œåˆå§‹åŒ–ï¼Œæœ‰å¾ˆå¤šå…¶ä»–æ•°æ®
            //è½¬å‚¨æˆNSDataï¼Œç¡®ä¿å¯¹æ­£ç¡®é•¿åº¦çš„cipherBufferçš„è·å–
            [data appendData:[NSData dataWithBytes:cipherBuffer length:cipherBufferSize]];    //7
            totalBufferSize += cipherBufferSize;    //8
        }
        //å¯¹å‰©ä½™çš„æ•°æ®è¿›è¡ŒåŠ å¯†
        status = SecKeyEncrypt(publicKey,
                               kSecPaddingPKCS1,
                               dataToEncrypt + (dataLength - toEncryptDataLength),
                               toEncryptDataLength,
                               cipherBuffer,
                               &amp;cipherBufferSize);
        [data appendData:[NSData dataWithBytes:cipherBuffer length:cipherBufferSize]];               
        totalBufferSize += cipherBufferSize;
    } else {
        //éœ€è¦åŠ å¯†çš„æ•°æ®é•¿åº¦å°äºSecKeyGetBlockSize(publicKey)ï¼11ï¼Œç›´æ¥åŠ å¯†
        status = SecKeyEncrypt(publicKey, kSecPaddingPKCS1, dataToEncrypt, dataLength, cipherBuffer, &amp;cipherBufferSize);
        [data appendData:[NSData dataWithBytes:cipherBuffer length:cipherBufferSize]];
    }
    if (publicKey) {
        CFRelease(publicKey);
    }
    NSString *encryptedString = [GTMBase64 stringByEncodingData:[data copy]];            //9
    free(cipherBuffer);            //10
    return encryptedString;
}
</code></pre>
<ol>
<li>æ ¹æ®Keyåˆ¤æ–­åŠ è§£å¯†å—å¤§å°ï¼ˆè‹¥ä½¿ç”¨kSecPaddingPKCS1ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒæ•´å—å¤§å°å°äºè¿™ä¸ªè¿”å›å€¼ - 11ï¼‰</li>
<li>åˆ›å»ºMutableDataç”¨ä»¥ä¸‹é¢æ“ä½œæ·»åŠ Data</li>
<li>åˆ¤æ–­æ•°æ®æ€»å¤§å°æ˜¯å¦å¤§äºSecKeyGetBlockSize(publicKey) - 11ï¼Œæ˜¯åˆ™æ‹†åˆ†æˆå¤šä¸ªå—åŠ è§£å¯†ï¼Œå¦åˆ™ç›´æ¥åŠ è§£å¯†ã€‚</li>
<li>whileå¾ªç¯å¤šæ¬¡æ“ä½œ</li>
<li>ä½¿ç”¨SecKeyEncryptè¿›è¡ŒåŠ è§£å¯†<pre><code class="objc">OSStatus SecKeyEncrypt(
 SecKeyRef           key,                //åŠ è§£å¯†ä½¿ç”¨çš„å¯†é’¥
 SecPadding          padding,            //paddingï¼Œä¸€èˆ¬ä¸ºkSecPaddingPKCS1ï¼Œéœ€è¦æ³¨æ„æ•°æ®å—çš„å¤§å°é—®é¢˜
 const uint8_t       *plainText,          //æ˜æ–‡
 size_t              plainTextLen,        //æ˜æ–‡é•¿åº¦
 uint8_t             *cipherText,        //è¿”å›çš„å¯†æ–‡
 size_t              *cipherTextLen)     //è¿”å›çš„å¯†æ–‡é•¿åº¦
 __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_2_0);
</code></pre>
</li>
<li>å°†å·²ç»åŠ è§£å¯†è¿‡çš„æ•°æ®å‰”é™¤</li>
<li>å¾€MutableDataä¸­æ·»åŠ æ•°æ®</li>
<li>è®¡ç®—æ€»çš„BufferSizeï¼Œè¿™é‡Œåªæ˜¯åšä¸ªç»Ÿè®¡</li>
<li>å°†å¾—åˆ°çš„æ•°æ®è¿›è¡ŒBase64è½¬ç </li>
<li>è®°å¾—é‡Šæ”¾cipherBuffer</li>
</ol>
<h4 id="decryptWithPrivateKey"><a href="#decryptWithPrivateKey" class="headerlink" title="decryptWithPrivateKey"></a>decryptWithPrivateKey</h4><pre><code class="objc">- (NSString *)decrypt: (NSString *)stringToDecrypt withPrivateKey:(SecKeyRef)privateKey {
    NSData *dataToDecrypt = [GTMBase64 decodeString:stringToDecrypt];
    OSStatus status = noErr;
    size_t cipherBufferSize = [dataToDecrypt length];
    uint8_t *cipherBuffer = (uint8_t *)[dataToDecrypt bytes];
    size_t plainBufferSize;
    uint8_t *plainBuffer;
    plainBufferSize = SecKeyGetBlockSize(privateKey);
    plainBuffer = malloc(plainBufferSize);
    NSMutableData *data = [[NSMutableData alloc] init];
    size_t decryptLengthPer = SecKeyGetBlockSize(privateKey);
    if (decryptLengthPer &lt; cipherBufferSize) {
        size_t toDecryptDataLength = cipherBufferSize;
        size_t totalBufferSize = 0;
        while (decryptLengthPer &lt; toDecryptDataLength) {
            status = SecKeyDecrypt(privateKey,
                                   kSecPaddingPKCS1,
                                   cipherBuffer + (cipherBufferSize - toDecryptDataLength),
                                   decryptLengthPer,
                                   plainBuffer,
                                   &amp;plainBufferSize);
            toDecryptDataLength = toDecryptDataLength - decryptLengthPer;
            if (status == noErr) {
                [data appendData:[NSData dataWithBytes:plainBuffer length:plainBufferSize]];
            }
            totalBufferSize += plainBufferSize;
        }
        status = SecKeyDecrypt(privateKey,
                               kSecPaddingPKCS1,
                               cipherBuffer + (cipherBufferSize - toDecryptDataLength),
                               decryptLengthPer,
                               plainBuffer,
                               &amp;plainBufferSize);
        if (status == noErr) {
            [data appendData:[NSData dataWithBytes:plainBuffer length:plainBufferSize]];
        }
        totalBufferSize += plainBufferSize;
    } else {
        status = SecKeyDecrypt(privateKey, kSecPaddingPKCS1, cipherBuffer, cipherBufferSize, plainBuffer, &amp;plainBufferSize);
        if (status == noErr) {
            [data appendData:[NSData dataWithBytes:plainBuffer length:plainBufferSize]];
        }
    }
    if (privateKey) {
        CFRelease(privateKey);
    }
    NSString *decryptedString = [[NSString alloc] initWithData:[data copy] encoding:NSUTF8StringEncoding];
    free(plainBuffer);
    return decryptedString;
}
</code></pre>
<p>è§£å¯†å’ŒåŠ å¯†çš„æ–¹å¼åŸºæœ¬ä¸€æ ·ï¼Œæ­¤å¤„ä¸å¤šåŠ èµ˜è¿°ã€‚<br><a href="https://github.com/objchris/PKIDemo" target="_blank" rel="external">Demo</a></p>
<p><strong>Hackerå›ï¼Œé—®ä½ æƒŠæœªï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆã€‚</strong><br>éå¯¹ç§°åŠ å¯†å¯¹é˜¿æ¾¤å›æ¥è¯´å®Œå…¨è§£å†³äº†é—®é¢˜(ã¥ï¿£ 3ï¿£)ã¥ï¼Œä½¿ç”¨è€å¸ˆçš„å…¬é’¥åŠ å¯†è®ºæ–‡åå‘é€å›ç»™ä»–ã€‚Hackerå›å°±ç®—æˆªå–åˆ°ä¹Ÿæ— æµäºäº‹ï¼Œå› ä¸ºHackerå›æ²¡æœ‰è€å¸ˆçš„ç§é’¥ï¼Œæ— æ³•è·å–åˆ°å…¶ä¸­çš„å†…å®¹ã€‚è€å¸ˆè·å–åˆ°é˜¿æ¾¤å›å‘é€çš„è®ºæ–‡åè‡ªç„¶å¯ä»¥è§£å¯†æŸ¥çœ‹ã€‚    </p>
<p><img src="http://7xs4ed.com1.z0.glb.clouddn.com/common/hahahahaha.jpg" alt="å“ˆå“ˆå“ˆå“ˆ"><br>ä»ä¸­é˜¿æ¾¤å›ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶â¤ï¸ã€‚æ•…äº‹æœ‰(fei)ç‚¹(chang)å¼±æ™ºï¼Œå¸Œæœ›å¤§å®¶ä¸è¦åœ¨æ„ï¼Œå…³æ³¨åŠ è§£å¯†ç®—æ³•å°±å¥½äº†~
ã€€ã€€</p>
<p>é¢˜å¤–è¯ï¼šPKIåŸºç¡€æœ€è¿‘æ‰æ¥è§¦ï¼Œå­¦å¾—ä¸æ·±ï¼Œæœ‰äº›ä¸œè¥¿å†™é”™è¯·å¤§å®¶è§è°…ã€‚<br>æ›´å¤šçš„ç®—æ³•ï¼Œegï¼šæ•°å­—æ‘˜è¦ã€æ•°å­—ç­¾åã€å£ä»¤è®¤è¯ç­‰ç­‰éƒ½åœ¨<a href="https://github.com/objchris/PKIDemo" target="_blank" rel="external">Github</a>ä¸Šäº†ï¼Œæœ‰å…´è¶£è¯·ç§»æ­¥ã€‚<br>å…³äºåŠ è§£å¯†ï¼Œè²Œä¼¼OpenSSLä¼šç»å¸¸ç”¨ï¼Œå…·ä½“é˜¿æ¾¤å›ä¹Ÿä¸æ¸…æ¥šï¼Œè¿˜éœ€è¦æ›´åŠ æ·±å…¥çš„å­¦ä¹ ï¼Œå…±å‹‰å§ï¼ï¼ï¼ï¼</p>

 
                <!-- Meta -->
                <div class="post-meta">
                    <hr>
                    <br>
                    
                    <div class="post-tags">
                        
                            

<a href="/tags/Security/">#Security</a>


                        
                    </div>
                    <div class="post-date">
                        2016 å¹´ 04 æœˆ 09 æ—¥
                    </div>
                </div>
            </div>

            <!-- Comments -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div id="container"></div>

<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">

<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  owner: 'objchris',
  repo: 'https://github.com/objchris/objchris.github.io',
  oauth: {
    client_id: 'f0f51ce99c6a9e1537f5',
    client_secret: 'a8e1135e9756220826b2290f670bb269f43566d3',
  },
})
gitment.render('container')
</script>

            </div>
        </div>
    </div>
</article>
</section>
<!-- Back to top -->
<a id="returnTop">
  <i class="fa fa-rocket"></i>
</a>



    <!-- Scripts -->
    <!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>

<script type="text/javascript">
	console.log('Chris Cheung Â© 2015-' + (new Date()).getFullYear());
</script>

<script src="/js/backtop.js"></script>
<script src="/js/search.js"></script>
    <!-- Google Analytics -->
    

</body>

</html>